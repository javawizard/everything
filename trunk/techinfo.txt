File structure.

In a versioned folder, there is a folder called ".ptm". Under this folder are a few things. 

First we have a folder called "diffs". it contains one file per revision. This file contains TODO: diffs for each file separated by some sort of delimiter that isn't one of "+-@ " and parse out with sed 

Then we have the "commandlist" file, which contains additional commands that need to be executed for each revision. This file is in the form of a shell script that contains a ton of if statements. There is one if statement per revision, which checks to see that the argument to the "commandlist" command is that particular revision number, and if so, then it executes a series of commands. There are three types of commands that will typically show up in here: mkdir commands, rm commands, and cp commands. If a new folder is added in a revision, then a mkdir command will be present here, which creates that folder. If a file or folder is removed in a revision, then an rm command will be here. If a new file is added in a revision, then the file will be present under the "new" folder (which I'll explain in a bit), and a cp command will be present here to copy the new file to it's proper location. The commandlist file is intended to be executed from the repository folder, not from the .ptm folder.

Then we have the "messages" file. This contains the commit message for all commits. Each line in the file starts with a number and an underscore. The number is the number of the revision that this particular line of the commit message is for. If a commit message has multiple lines (not supported in ptm commit right now, but could be added later), then there are multiple lines in this file that start with the revision number and an underscore. To get the commit message for a particular revision, sed -e

Then we have the "head" folder. The contents of this folder exactly mirror the working copy, and are used to check for differences when the working copy is committed.

There is also a folder called "tmp". Temporary files are put into this folder. ptm removes the contents of this folder whenever it is run, so if leftover files remain for some reason, they won't get stuck for long.









Yes, PersonalTimeMachine contains a lot of uses of the "cat" command where the "<" operator would be faster. I'll get around to removing these sometime.