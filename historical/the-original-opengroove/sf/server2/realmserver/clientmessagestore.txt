This document describes the method in which clients store messages when offline, and forward them to the server when online.

Messages that have been received and successfully processed by a message consumer in OpenGroove are not retained by the message store, and must be retained by the consumer if they are to be persistant.

TODO: figure out how to allow multiple recipients of a message. Perhaps chunks should have their own id and not be specific to a message. Then, a chunk could remain as long as there is still a message referencing it, and the chunk would contribute to the storage quotas of all users of a particular message. In otherwords, a chunk that is a member of a stored message that has not been finalized yet would contribute to the sender's storage quota. A chunk that is a member of a stored message that has been finalized would contribute to all recipient's storage quotas, but only once (meaning that if two or more messages reference a chunk, and both are to the same recipient, the chunk only contributes once to the recipient's storage quota, and not once per message using it). When all messages that use a chunk are deleted, the chunk is deleted. If a message is finalized but some of it's recipients are on another realm server and that realm server has not downloaded the message yet, then the message still contributes to the sender's storage quota. Perhaps, then, when a new message is created, it should reference existing chunks on the server, and chunks are managed independantly of messages themselves. This poses another problem, however, of who should bear the weight of the chunk's data.

When a component of the system wishes to send a stored message to a particular user